"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return e=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(e,t,o){if(o||2===arguments.length)for(var n,r=0,p=t.length;r<p;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}function o(t,o){var n,r,p=(n={current:0,next:function(){return++this.current}},r={},{add:function(e,t){var o=null!=t?t:n.next();return r[o]=e,o},resolve:function(e,t,o){var n=r[e];n&&(o(t)?n.resolve(t):n.reject(t),r[e]=null)}});return o((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,o=t.request_id,n=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o}(t,["request_id"]);o&&p.resolve(o,n,(function(e){return!("error_type"in e)}))}})),function(o,n){return void 0===n&&(n={}),new Promise((function(r,i){var a=p.add({resolve:r,reject:i},n.request_id);t(o,e(e({},n),{request_id:a}))}))}}var n="undefined"!=typeof window,r=Boolean(n&&window.AndroidBridge),p=Boolean(n&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),i=Boolean(n&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),a=n&&!r&&!p,s=a&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),d=a?"message":"VKWebAppEvent",u=t(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet"],a&&!s?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppGetFriends","VKWebAppShowCommunityWidgetPreviewBox"]:["VKWebAppShowImages"],!0),l=n?window.AndroidBridge:void 0,c=p?window.webkit.messageHandlers:void 0,b=a?parent:void 0;var A,f,W,V,K,m,w;exports.EAdsFormats=void 0,(A=exports.EAdsFormats||(exports.EAdsFormats={})).REWARD="reward",A.INTERSTITIAL="interstitial",exports.BannerAdLayoutType=void 0,(f=exports.BannerAdLayoutType||(exports.BannerAdLayoutType={})).RESIZE="resize",f.OVERLAY="overlay",exports.BannerAdLocation=void 0,(W=exports.BannerAdLocation||(exports.BannerAdLocation={})).TOP="top",W.BOTTOM="bottom",exports.EGrantedPermission=void 0,(V=exports.EGrantedPermission||(exports.EGrantedPermission={})).CAMERA="camera",V.LOCATION="location",V.PHOTO="photo",exports.EGetLaunchParamsResponseLanguages=void 0,(K=exports.EGetLaunchParamsResponseLanguages||(exports.EGetLaunchParamsResponseLanguages={})).RU="ru",K.UK="uk",K.UA="ua",K.EN="en",K.BE="be",K.KZ="kz",K.PT="pt",K.ES="es",exports.EGetLaunchParamsResponseGroupRole=void 0,(m=exports.EGetLaunchParamsResponseGroupRole||(exports.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",m.EDITOR="editor",m.MEMBER="member",m.MODER="moder",m.NONE="none",exports.EGetLaunchParamsResponsePlatforms=void 0,(w=exports.EGetLaunchParamsResponsePlatforms||(exports.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",w.MOBILE_WEB="mobile_web",w.MOBILE_ANDROID="mobile_android",w.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",w.MOBILE_IPHONE="mobile_iphone",w.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",w.MOBILE_IPAD="mobile_ipad";var v=function(e){var n=void 0,s=[];function A(e){s.push(e)}function f(){return p||r}function W(){return a&&window.parent!==window}function V(){return f()||W()}function K(e){if(p||r)return t([],s,!0).map((function(t){return t.call(null,e)}));var o=null==e?void 0:e.data;if(a&&o){if(i&&"string"==typeof o)try{o=JSON.parse(o)}catch(e){}var d=o.type,u=o.data,l=o.frameId;d&&("VKWebAppSettings"!==d?t([],s,!0).map((function(e){return e({detail:{type:d,data:u}})})):n=l)}}i&&/(android)/i.test(navigator.userAgent)?document.addEventListener(d,K):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(d,K);var m=o((function(t,o){l&&l[t]?l[t](JSON.stringify(o)):c&&c[t]&&"function"==typeof c[t].postMessage?c[t].postMessage(o):i?window.ReactNativeWebView.postMessage(JSON.stringify({handler:t,params:o})):b&&"function"==typeof b.postMessage&&b.postMessage({handler:t,params:o,type:"vk-connect",webFrameId:n,connectVersion:e},"*")}),A);return{send:m,sendPromise:m,subscribe:A,unsubscribe:function(e){var t=s.indexOf(e);t>-1&&s.splice(t,1)},supports:function(e){return r?!(!l||"function"!=typeof l[e]):p?!(!c||!c[e]||"function"!=typeof c[e].postMessage):!!a&&u.includes(e)},isWebView:f,isIframe:W,isEmbedded:V,isStandalone:function(){return!V()}}}("2.8.2");exports.applyMiddleware=function t(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];return o.includes(void 0)||o.includes(null)?t.apply(void 0,o.filter((function(e){return"function"==typeof e}))):function(t){if(0===o.length)return t;var n,r={subscribe:t.subscribe,send:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.send.apply(t,e)}},p=o.filter((function(e){return"function"==typeof e})).map((function(e){return e(r)})).reduce((function(e,t){return function(o){return e(t(o))}}));return n=p(t.send),e(e({},t),{send:n})}},exports.default=v;
//# sourceMappingURL=index.js.map
